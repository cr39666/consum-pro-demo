import{o as h,a as p,c as m,b as i,u as o,n as g,t as c,r as P}from"./index-c6KZ6AP5.js";const _={class:"about"},f={class:"handleArea"},k={class:"text"},S={class:"console"},v=i("input",{type:"text",placeholder:"库存变动详情↓"},null,-1),x=i("div",{id:"log",class:"log"},null,-1),y={__name:"AboutView",setup(R){class r{constructor(){this.data=P({stock:0,points:0,expend:0,isProduce:!1,customerCount:0,produceRate:3,consumeRate:2,isAutoScrolling:!0})}producePoints(){console.log("点击生产"),this.data.isProduce=!this.data.isProduce,this.updatePoints(4,this.data.isProduce?"开始生产":"停止生产"),this.data.isProduce?this.produce():clearTimeout(this.produceTimeout)}produce(){this.data.isProduce&&(this.data.points+=this.data.produceRate,this.data.stock+=this.data.produceRate,this.updatePoints(1),this.produceTimeout=setTimeout(()=>this.produce(),1e3))}consumePoints(){this.data.customerCount++;const t=this.data.customerCount;this.consume(t)}consume(t){this.data.stock-this.data.consumeRate>=0?(this.data.stock-=this.data.consumeRate,this.data.expend+=this.data.consumeRate,this.updatePoints(2,t),setTimeout(()=>this.consume(t),1e3)):(this.updatePoints(3,t),setTimeout(()=>this.consume(t),1e3))}updatePoints(t,s){let n="";switch(t){case 1:n=`生产了${this.data.produceRate}个`;break;case 2:n=`顾客${s}消费了${this.data.consumeRate}个`;break;case 3:n=`顾客${s}欲消费${this.data.consumeRate}个,但库存不足，未消费`;break;case 4:n=s;break;default:n="?"}let l=document.createElement("div"),u=`${n}，库存剩余${this.data.stock}个`;l.innerText=u,this.log(u);let d=document.getElementById("log");d.appendChild(l),this.data.isAutoScrolling&&(d.scrollTop=d.scrollHeight),d.childElementCount>100&&d.removeChild(d.firstElementChild)}log(t){let s=JSON.parse(localStorage.getItem("log"))||[];s.push(t),localStorage.setItem("log",JSON.stringify(s))}}const e=new r;return h(()=>{localStorage.clear();let a=document.getElementById("log");a.addEventListener("scroll",function(){a.scrollTop<a.scrollHeight-a.clientHeight?e.isAutoScrolling=!1:e.isAutoScrolling=!0})}),(a,t)=>(p(),m("div",_,[i("div",f,[i("div",null,[i("button",{onClick:t[0]||(t[0]=(...s)=>o(e).producePoints&&o(e).producePoints(...s)),style:g({color:o(e).data.isProduce?"green":"red"})},c(o(e).data.isProduce?"生产ing":"停产ing"),5),i("button",{onClick:t[1]||(t[1]=(...s)=>o(e).consumePoints&&o(e).consumePoints(...s))},"消耗")])]),i("div",k,[i("div",S,[i("h3",null,"生产量："+c(o(e).data.points)+"    消耗量："+c(o(e).expend)+"     库存："+c(o(e).data.stock),1),v]),x])]))}};export{y as default};
